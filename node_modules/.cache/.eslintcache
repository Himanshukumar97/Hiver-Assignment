[{"/Users/himanshukumar/Documents/hiver-assignment/src/index.js":"1","/Users/himanshukumar/Documents/hiver-assignment/src/App.js":"2","/Users/himanshukumar/Documents/hiver-assignment/src/pages/Home/Store/reducer.js":"3","/Users/himanshukumar/Documents/hiver-assignment/src/pages/Home/Store/actionTypes.js":"4","/Users/himanshukumar/Documents/hiver-assignment/src/pages/Home/index.js":"5","/Users/himanshukumar/Documents/hiver-assignment/src/pages/Home/Store/action.js":"6","/Users/himanshukumar/Documents/hiver-assignment/src/reportWebVitals.js":"7"},{"size":732,"mtime":1616876530573,"results":"8","hashOfConfig":"9"},{"size":404,"mtime":1616876397482,"results":"10","hashOfConfig":"9"},{"size":2126,"mtime":1616962724464,"results":"11","hashOfConfig":"9"},{"size":199,"mtime":1616924088599,"results":"12","hashOfConfig":"9"},{"size":8807,"mtime":1616963311290,"results":"13","hashOfConfig":"9"},{"size":917,"mtime":1616962682637,"results":"14","hashOfConfig":"9"},{"size":362,"mtime":1616875516747,"results":"15","hashOfConfig":"9"},{"filePath":"16","messages":"17","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"1hzdl7f",{"filePath":"18","messages":"19","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"20","messages":"21","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"22","messages":"23","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"24","messages":"25","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"26"},{"filePath":"27","messages":"28","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"29","messages":"30","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"/Users/himanshukumar/Documents/hiver-assignment/src/index.js",[],"/Users/himanshukumar/Documents/hiver-assignment/src/App.js",[],"/Users/himanshukumar/Documents/hiver-assignment/src/pages/Home/Store/reducer.js",[],"/Users/himanshukumar/Documents/hiver-assignment/src/pages/Home/Store/actionTypes.js",[],"/Users/himanshukumar/Documents/hiver-assignment/src/pages/Home/index.js",["31","32","33"],"import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport searchIcon from './search.png';\nimport './index.css';\nimport * as actions from './Store/action';\nimport cx from 'classnames';\nimport _ from 'lodash';\nclass HomePage extends Component {\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      query: '',\n      result: [],\n      page: 1\n    }\n    this.debounceTimer = null;\n  }\n\n  componentDidMount() {\n  }\n  componentDidUpdate(prevProps, prevState) {\n    if (prevProps.data !== this.props.data && (this.props.hitsPerQuery === this.props.hitsPerPage || this.props.lastPage === true)) {\n      this.searchFilter();\n    }\n    else if (!_.isEmpty(this.state.query) && !_.isEmpty(this.props.queryHitted) &&\n      this.props.queryHitted === this.state.query) {\n      if (this.props.data.length > 0 && this.props.hitsPerQuery === this.props.hitsPerPage && this.props.hitsPerPage > 0 && this.state.result.length < 10 && this.props.lastPage === false) {\n        console.log(\"prevState.query \", prevState.query, this.state.query);\n\n        console.log(\"true \", this.state.page, this.props.hitsPerQuery, this.state.result.length);\n        let page = (this.state.page) + 1;\n        const debouncer = this.debounceFunction(this.state.query, page, this.callAPI, 1000, true);\n        debouncer();\n      }\n    }\n  }\n\n  intersectFunc = (a, b) => {\n    return b.filter(function (e) {\n      if (a.includes(e))\n        return true;\n    }).filter(function (e, i, c) { // extra step to remove duplicates\n      return c.indexOf(e) === i;\n    });\n\n  }\n  searchFilter = (query) => {\n\n\n    let searchArray = [];\n    if (_.isEmpty(query))\n      query = this.state.query;\n    console.log(\"query search filter\", query);\n\n    let thisPar = this;\n    let resultArray = _.cloneDeep(this.props.data);\n    if (_.isEmpty(query)) {\n      searchArray = [];\n    }\n    else {\n      searchArray = resultArray.filter(function (obj) {\n\n        let keys = ['title', 'url', 'author', 'story_text', 'story_title']\n        var intersectfunc = thisPar.intersectFunc;\n\n        query = query.toLowerCase();\n        let queryArray = query.split(\" \");\n        for (var objkey in obj) {\n          if (obj.hasOwnProperty(objkey) && _.includes(keys, objkey) && !_.isEmpty(obj[objkey])) {\n            let intersectedArray = intersectfunc(obj[objkey].toLowerCase(), queryArray);\n            if (intersectedArray.length === queryArray.length) {\n              return true;\n            }\n\n          }\n        }\n\n      });\n\n    }\n\n    if (searchArray.length > 10)\n      searchArray = searchArray.slice(0, 10);\n\n    this.setState({ result: searchArray });\n    return searchArray;\n\n  }\n\n  callAPI = (query, page,changePage) =>{\n    if (changePage === true)\n      this.setState({ page });\n\n      this.props.getData(query,page);\n    \n  }\n  debounceFunction = (query, page, fn, td, changePage) => {\n\n    let thisPar = this;\n    return function () {\n      const context = this;\n      clearTimeout(thisPar.debounceTimer)\n      thisPar.debounceTimer = setTimeout(() => fn.call(context, query, page,changePage), td);\n    }\n\n  }\n\n\n  handleOnInputChange = (event) => {\n\n    const query = event.target.value;\n    let page = this.state.page;\n    let searchArray = this.searchFilter(query)\n    if (searchArray.length < 10) {\n      const debouncer = this.debounceFunction(query, page, this.callAPI, 1000);\n      debouncer();\n    }\n\n    console.log(\"query input change\", query);\n\n    this.setState({ query, page: 1 });\n\n\n  }\n  convertMS = (milliseconds) => {\n    let day, hour, minute, seconds, week, month, year, time = \"\";\n    seconds = Math.floor(milliseconds / 1000);\n    minute = Math.floor(seconds / 60);\n    seconds = seconds % 60;\n    hour = Math.floor(minute / 60);\n    minute = minute % 60;\n    day = Math.floor(hour / 24);\n    week = Math.floor(day / 7);\n    hour = hour % 24;\n    day = day % 7;\n    month = Math.floor(day / 30);\n    year = Math.floor(day / 365);\n\n    if (year > 0) {\n      time += year + ' year';\n      if (year > 1)\n        time += 's';\n      time += ' ago';\n    }\n\n    else if (month > 0) {\n      time += month + ' month';\n      if (month > 1)\n        time += 's';\n      time += ' ago';\n    }\n    else if (week > 0) {\n      time += week + ' week';\n      if (week > 1)\n        time += 's';\n      time += ' ago';\n    }\n    else if (day > 0) {\n      time += day + ' day';\n      if (day > 1)\n        time += 's';\n      time += ' ago';\n    }\n    else if (hour > 0) {\n      time += hour + ' hour';\n      if (hour > 1)\n        time += 's';\n      time += ' ago';\n    }\n    else if (minute > 0) {\n      time += minute + ' minute';\n      if (minute > 1)\n        time += 's';\n      time += ' ago';\n    }\n    else if (seconds > 0) {\n      time += seconds + ' seconds';\n      if (seconds > 1)\n        time += 's';\n      time += ' ago';\n    }\n    return time;\n  }\n  postMessage = (postDate) => {\n    let d = new Date();\n    let n = d.getMilliseconds();\n\n    let postAgeInMilSec = postDate - n;\n    let postAage = this.convertMS(postAgeInMilSec);\n    return postAage;\n\n  }\n  getText = (text, searchText) => {\n    return searchText ? this.getTextWithHighlights(text, searchText) : text;\n  }\n  getTextWithHighlights = (text, searchText) => {\n    searchText = searchText.split(\" \");\n    searchText.forEach(eachQuery => {\n      const regex = new RegExp(eachQuery, 'gi');\n      text = text.replaceAll(regex, `<mark class=\"highlight\">$&</mark>`);\n\n    });\n    return <span dangerouslySetInnerHTML={{ __html: text }} />;\n  }\n\n  render() {\n    let searchResults = [];\n    let result = _.cloneDeep(this.state.result);\n    let thisPar = this;\n    var t;\n    if (result.length > 0) {\n\n      result.forEach(function (item, index) {\n        searchResults.push(\n          <div key={index} className=\"padding\">\n\n            {item.url || item.title ?\n              <div className=\"subList\">\n\n                <span className=\"spanWithBlack\" id={\"spanDemo\"} key={index} >{item.title ?\n                  thisPar.getText(item.title, thisPar.state.query) : null} </span>\n                <span className=\"storyUrl\">{item.url ? '(' : null} {item.url ?\n                  thisPar.getText(item.url, thisPar.state.query) : null} {item.url ? ')' : null} </span>\n\n              </div>\n              :\n              null\n            }\n            {item.author || item.num_comments ?\n              <div className=\"subList\">\n                {item.author ?\n                  <span>\n                    Author: {thisPar.getText(item.author, thisPar.state.query)}\n                  </span>\n                  :\n                  null}\n                {item.num_comments ?\n                  <span>\n                    {item.author ? <React.Fragment> | </React.Fragment> : null}\n                    comments: {item.num_comments}\n                  </span>\n                  :\n                  null}\n                {item.created_at_i ?\n                  <span>\n                    {item.author || item.num_comments ? <React.Fragment> | </React.Fragment> : null}\n                    {thisPar.postMessage(item.created_at_i)}\n                  </span>\n                  :\n                  null}\n\n              </div>\n              : null}\n            {item.story_text ? <div className=\"subList spanWithBlack\">\n              {thisPar.getText(item.story_text, thisPar.state.query)}\n            </div> : null}\n\n            <hr className=\"horizontalLine\" />\n          </div>\n        )\n      })\n    }\n\n    return (\n      <div className=\"maindiv\">\n        <h2>\n          Search Hacker News\n        </h2>\n        <div className=\"dropDown\">\n          <div className={cx(\"\")} >\n            <img src={searchIcon} alt=\"searchIcon\" className=\"searchIcon\" />\n            <input className=\"searchBox\"\n              id=\"mySearchInput\"\n              placeholder=\"Type here to start searching\"\n              onKeyUp={(event) => this.handleOnInputChange(event)}\n              autoComplete=\"off\"\n            />\n\n            {this.props.getDataState === \"LOADING\" ? <div className=\"loader\"></div> :\n              _.isEmpty(this.state.query) || result.length > 0\n                ? <div className=\"itemResults\">\n                  {searchResults}\n                </div>\n                : <div className=\"itemResults\"> \"NO DATA FOUND WITH THE SEARCH\" </div>}\n          </div>\n\n\n\n\n\n        </div>\n\n\n      </div>\n    );\n  }\n\n}\nconst mapStateToProps = state => {\n  return {\n    data: state.data,\n    lastPage: state.lastPage,\n    getDataState: state.getDataState,\n    hitsPerQuery: state.hitsPerQuery,\n    hitsPerPage: state.hitsPerPage,\n    queryHitted: state.queryHitted\n  };\n};\n\n\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    getData: (query, page) => dispatch(actions.getData(query, page)),\n  };\n};\n\nexport default (connect(mapStateToProps, mapDispatchToProps)(HomePage));\n\n","/Users/himanshukumar/Documents/hiver-assignment/src/pages/Home/Store/action.js",[],"/Users/himanshukumar/Documents/hiver-assignment/src/reportWebVitals.js",[],{"ruleId":"34","severity":1,"message":"35","line":40,"column":21,"nodeType":"36","messageId":"37","endLine":40,"endColumn":30},{"ruleId":"34","severity":1,"message":"35","line":62,"column":40,"nodeType":"36","messageId":"37","endLine":62,"endColumn":49},{"ruleId":"38","severity":1,"message":"39","line":211,"column":9,"nodeType":"40","messageId":"41","endLine":211,"endColumn":10},"array-callback-return","Array.prototype.filter() expects a value to be returned at the end of function.","FunctionExpression","expectedAtEnd","no-unused-vars","'t' is defined but never used.","Identifier","unusedVar"]