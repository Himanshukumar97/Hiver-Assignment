{"ast":null,"code":"var _jsxFileName = \"/Users/himanshukumar/Documents/hiver-assignment/src/pages/Home/index.js\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport searchIcon from './search.png';\nimport './index.css';\nimport * as actions from './Store/action';\nimport cx from 'classnames';\nimport _ from 'lodash';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass HomePage extends Component {\n  constructor(props) {\n    super(props);\n\n    this.intersectFunc = (a, b) => {\n      return b.filter(function (e) {\n        if (a.includes(e)) return true;\n      }).filter(function (e, i, c) {\n        // extra step to remove duplicates\n        return c.indexOf(e) === i;\n      });\n    };\n\n    this.searchFilter = query => {\n      let searchArray = [];\n      if (_.isEmpty(query)) query = this.state.query;\n      console.log(\"query search filter\", query);\n      let thisPar = this;\n\n      let resultArray = _.cloneDeep(this.props.data);\n\n      if (_.isEmpty(query)) {\n        searchArray = [];\n      } else {\n        searchArray = resultArray.filter(function (obj) {\n          let keys = ['title', 'url', 'author', 'story_text', 'story_title'];\n          var intersectfunc = thisPar.intersectFunc;\n          query = query.toLowerCase();\n          let queryArray = query.split(\" \");\n\n          for (var objkey in obj) {\n            if (obj.hasOwnProperty(objkey) && _.includes(keys, objkey) && !_.isEmpty(obj[objkey])) {\n              let intersectedArray = intersectfunc(obj[objkey].toLowerCase(), queryArray);\n\n              if (intersectedArray.length === queryArray.length) {\n                return true;\n              }\n            }\n          }\n        });\n      }\n\n      if (searchArray.length > 10) searchArray = searchArray.slice(0, 10);\n      this.setState({\n        result: searchArray,\n        page: 1\n      });\n      return searchArray;\n    };\n\n    this.callAPI = changePage => {\n      if (changePage === true) this.setState({\n        page\n      });\n      this.props.getData(query, page);\n    };\n\n    this.debounceFunction = (query, page, fn, td, changePage) => {\n      let thisPar = this;\n      return function () {\n        const context = this;\n        clearTimeout(thisPar.debounceTimer);\n        thisPar.debounceTimer = setTimeout(() => fn.call(context, query, page), td);\n      };\n    };\n\n    this.handleOnInputChange = event => {\n      const query = event.target.value;\n      let page = this.state.page;\n      let searchArray = this.searchFilter(query);\n\n      if (searchArray.length < 10) {\n        const debouncer = this.debounceFunction(query, page, this.props.getData, 1000);\n        debouncer();\n      }\n\n      console.log(\"query input change\", query);\n      this.setState({\n        query,\n        page: 1\n      });\n    };\n\n    this.convertMS = milliseconds => {\n      let day,\n          hour,\n          minute,\n          seconds,\n          week,\n          month,\n          year,\n          time = \"\";\n      seconds = Math.floor(milliseconds / 1000);\n      minute = Math.floor(seconds / 60);\n      seconds = seconds % 60;\n      hour = Math.floor(minute / 60);\n      minute = minute % 60;\n      day = Math.floor(hour / 24);\n      week = Math.floor(day / 7);\n      hour = hour % 24;\n      day = day % 7;\n      month = Math.floor(day / 30);\n      year = Math.floor(day / 365);\n\n      if (year > 0) {\n        time += year + ' year';\n        if (year > 1) time += 's';\n        time += ' ago';\n      } else if (month > 0) {\n        time += month + ' month';\n        if (month > 1) time += 's';\n        time += ' ago';\n      } else if (week > 0) {\n        time += week + ' week';\n        if (week > 1) time += 's';\n        time += ' ago';\n      } else if (day > 0) {\n        time += day + ' day';\n        if (day > 1) time += 's';\n        time += ' ago';\n      } else if (hour > 0) {\n        time += hour + ' hour';\n        if (hour > 1) time += 's';\n        time += ' ago';\n      } else if (minute > 0) {\n        time += minute + ' minute';\n        if (minute > 1) time += 's';\n        time += ' ago';\n      } else if (seconds > 0) {\n        time += seconds + ' seconds';\n        if (seconds > 1) time += 's';\n        time += ' ago';\n      }\n\n      return time;\n    };\n\n    this.postMessage = postDate => {\n      let d = new Date();\n      let n = d.getMilliseconds();\n      let postAgeInMilSec = postDate - n;\n      let postAage = this.convertMS(postAgeInMilSec);\n      return postAage;\n    };\n\n    this.getText = (text, searchText) => {\n      return searchText ? this.getTextWithHighlights(text, searchText) : text;\n    };\n\n    this.getTextWithHighlights = (text, searchText) => {\n      searchText = searchText.split(\" \");\n      searchText.forEach(eachQuery => {\n        const regex = new RegExp(eachQuery, 'gi');\n        text = text.replaceAll(regex, `<mark class=\"highlight\">$&</mark>`);\n      });\n      return /*#__PURE__*/_jsxDEV(\"span\", {\n        dangerouslySetInnerHTML: {\n          __html: text\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 12\n      }, this);\n    };\n\n    this.state = {\n      query: '',\n      result: [],\n      page: 1\n    };\n    this.debounceTimer = null;\n  }\n\n  componentDidMount() {}\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevProps.data !== this.props.data && (this.props.hitsPerQuery === this.props.hitsPerPage || this.props.lastPage === true)) {\n      this.searchFilter();\n    } else if (!_.isEmpty(this.state.query) && !_.isEmpty(this.props.queryHitted) && this.props.queryHitted === this.state.query) {\n      if (this.props.data.length > 0 && this.props.hitsPerQuery === this.props.hitsPerPage && this.props.hitsPerPage > 0 && this.state.result.length < 10 && this.props.lastPage === false) {\n        console.log(\"prevState.query \", prevState.query, this.state.query);\n        console.log(\"true \", this.state.page, this.props.hitsPerQuery, this.state.result.length);\n        let page = this.state.page + 1;\n        const debouncer = this.debounceFunction(this.state.query, page, this.props.getData, 1000, true);\n        debouncer();\n      }\n    }\n  }\n\n  render() {\n    let searchResults = [];\n\n    let result = _.cloneDeep(this.state.result);\n\n    let thisPar = this;\n    var t;\n\n    if (result.length > 0) {\n      result.forEach(function (item, index) {\n        searchResults.push( /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"padding\",\n          children: [item.url || item.title ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"subList\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"spanWithBlack\",\n              id: \"spanDemo\",\n              children: [item.title ? thisPar.getText(item.title, thisPar.state.query) : null, \" \"]\n            }, index, true, {\n              fileName: _jsxFileName,\n              lineNumber: 220,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"storyUrl\",\n              children: [item.url ? '(' : null, \" \", item.url ? thisPar.getText(item.url, thisPar.state.query) : null, \" \", item.url ? ')' : null, \" \"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 222,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 15\n          }, this) : null, item.author || item.num_comments ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"subList\",\n            children: [item.author ? /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"Author: \", thisPar.getText(item.author, thisPar.state.query)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 19\n            }, this) : null, item.num_comments ? /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [item.author ? /*#__PURE__*/_jsxDEV(React.Fragment, {\n                children: \" | \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 239,\n                columnNumber: 36\n              }, this) : null, \"comments: \", item.num_comments]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 238,\n              columnNumber: 19\n            }, this) : null, item.created_at_i ? /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [item.author || item.num_comments ? /*#__PURE__*/_jsxDEV(React.Fragment, {\n                children: \" | \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 246,\n                columnNumber: 57\n              }, this) : null, thisPar.postMessage(item.created_at_i)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 19\n            }, this) : null]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 15\n          }, this) : null, item.story_text ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"subList spanWithBlack\",\n            children: thisPar.getText(item.story_text, thisPar.state.query)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 254,\n            columnNumber: 32\n          }, this) : null, /*#__PURE__*/_jsxDEV(\"hr\", {\n            className: \"horizontalLine\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 13\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 11\n        }, this));\n      });\n    }\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"maindiv\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Search Hacker News\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"dropDown\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: cx(\"\"),\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: searchIcon,\n            alt: \"searchIcon\",\n            className: \"searchIcon\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 271,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            className: \"searchBox\",\n            id: \"mySearchInput\",\n            placeholder: \"Type here to start searching\",\n            onKeyUp: event => this.handleOnInputChange(event),\n            autoComplete: \"off\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 272,\n            columnNumber: 13\n          }, this), this.props.getDataState === \"LOADING\" ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"loader\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 279,\n            columnNumber: 54\n          }, this) : _.isEmpty(this.state.query) || result.length > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"itemResults\",\n            children: searchResults\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 19\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"itemResults\",\n            children: \" \\\"NO DATA FOUND WITH THE SEARCH\\\" \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    data: state.data,\n    lastPage: state.lastPage,\n    getDataState: state.getDataState,\n    hitsPerQuery: state.hitsPerQuery,\n    hitsPerPage: state.hitsPerPage,\n    queryHitted: state.queryHitted\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    getData: (query, page) => dispatch(actions.getData(query, page))\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(HomePage);","map":{"version":3,"sources":["/Users/himanshukumar/Documents/hiver-assignment/src/pages/Home/index.js"],"names":["React","Component","connect","searchIcon","actions","cx","_","HomePage","constructor","props","intersectFunc","a","b","filter","e","includes","i","c","indexOf","searchFilter","query","searchArray","isEmpty","state","console","log","thisPar","resultArray","cloneDeep","data","obj","keys","intersectfunc","toLowerCase","queryArray","split","objkey","hasOwnProperty","intersectedArray","length","slice","setState","result","page","callAPI","changePage","getData","debounceFunction","fn","td","context","clearTimeout","debounceTimer","setTimeout","call","handleOnInputChange","event","target","value","debouncer","convertMS","milliseconds","day","hour","minute","seconds","week","month","year","time","Math","floor","postMessage","postDate","d","Date","n","getMilliseconds","postAgeInMilSec","postAage","getText","text","searchText","getTextWithHighlights","forEach","eachQuery","regex","RegExp","replaceAll","__html","componentDidMount","componentDidUpdate","prevProps","prevState","hitsPerQuery","hitsPerPage","lastPage","queryHitted","render","searchResults","t","item","index","push","url","title","author","num_comments","created_at_i","story_text","getDataState","mapStateToProps","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport searchIcon from './search.png';\nimport './index.css';\nimport * as actions from './Store/action';\nimport cx from 'classnames';\nimport _ from 'lodash';\nclass HomePage extends Component {\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      query: '',\n      result: [],\n      page: 1\n    }\n    this.debounceTimer = null;\n  }\n\n  componentDidMount() {\n  }\n  componentDidUpdate(prevProps, prevState) {\n    if (prevProps.data !== this.props.data && (this.props.hitsPerQuery === this.props.hitsPerPage || this.props.lastPage === true)) {\n      this.searchFilter();\n    }\n    else if (!_.isEmpty(this.state.query) && !_.isEmpty(this.props.queryHitted) &&\n      this.props.queryHitted === this.state.query) {\n      if (this.props.data.length > 0 && this.props.hitsPerQuery === this.props.hitsPerPage && this.props.hitsPerPage > 0 && this.state.result.length < 10 && this.props.lastPage === false) {\n        console.log(\"prevState.query \", prevState.query, this.state.query);\n\n        console.log(\"true \", this.state.page, this.props.hitsPerQuery, this.state.result.length);\n        let page = (this.state.page) + 1;\n        const debouncer = this.debounceFunction(this.state.query, page, this.props.getData, 1000, true);\n        debouncer();\n      }\n    }\n  }\n\n  intersectFunc = (a, b) => {\n    return b.filter(function (e) {\n      if (a.includes(e))\n        return true;\n    }).filter(function (e, i, c) { // extra step to remove duplicates\n      return c.indexOf(e) === i;\n    });\n\n  }\n  searchFilter = (query) => {\n\n\n    let searchArray = [];\n    if (_.isEmpty(query))\n      query = this.state.query;\n    console.log(\"query search filter\", query);\n\n    let thisPar = this;\n    let resultArray = _.cloneDeep(this.props.data);\n    if (_.isEmpty(query)) {\n      searchArray = [];\n    }\n    else {\n      searchArray = resultArray.filter(function (obj) {\n\n        let keys = ['title', 'url', 'author', 'story_text', 'story_title']\n        var intersectfunc = thisPar.intersectFunc;\n\n        query = query.toLowerCase();\n        let queryArray = query.split(\" \");\n        for (var objkey in obj) {\n          if (obj.hasOwnProperty(objkey) && _.includes(keys, objkey) && !_.isEmpty(obj[objkey])) {\n            let intersectedArray = intersectfunc(obj[objkey].toLowerCase(), queryArray);\n            if (intersectedArray.length === queryArray.length) {\n              return true;\n            }\n\n          }\n        }\n\n      });\n\n    }\n\n    if (searchArray.length > 10)\n      searchArray = searchArray.slice(0, 10);\n\n    this.setState({ result: searchArray, page: 1 });\n    return searchArray;\n\n  }\n\n  callAPI = (changePage) =>{\n    if (changePage === true)\n      this.setState({ page });\n      this.props.getData(query,page);\n    \n  }\n  debounceFunction = (query, page, fn, td, changePage) => {\n\n    let thisPar = this;\n    return function () {\n      const context = this;\n      clearTimeout(thisPar.debounceTimer)\n      thisPar.debounceTimer = setTimeout(() => fn.call(context, query, page), td);\n    }\n\n  }\n\n\n  handleOnInputChange = (event) => {\n\n    const query = event.target.value;\n    let page = this.state.page;\n    let searchArray = this.searchFilter(query)\n    if (searchArray.length < 10) {\n      const debouncer = this.debounceFunction(query, page, this.props.getData, 1000);\n      debouncer();\n    }\n\n    console.log(\"query input change\", query);\n\n    this.setState({ query, page: 1 });\n\n\n  }\n  convertMS = (milliseconds) => {\n    let day, hour, minute, seconds, week, month, year, time = \"\";\n    seconds = Math.floor(milliseconds / 1000);\n    minute = Math.floor(seconds / 60);\n    seconds = seconds % 60;\n    hour = Math.floor(minute / 60);\n    minute = minute % 60;\n    day = Math.floor(hour / 24);\n    week = Math.floor(day / 7);\n    hour = hour % 24;\n    day = day % 7;\n    month = Math.floor(day / 30);\n    year = Math.floor(day / 365);\n\n    if (year > 0) {\n      time += year + ' year';\n      if (year > 1)\n        time += 's';\n      time += ' ago';\n    }\n\n    else if (month > 0) {\n      time += month + ' month';\n      if (month > 1)\n        time += 's';\n      time += ' ago';\n    }\n    else if (week > 0) {\n      time += week + ' week';\n      if (week > 1)\n        time += 's';\n      time += ' ago';\n    }\n    else if (day > 0) {\n      time += day + ' day';\n      if (day > 1)\n        time += 's';\n      time += ' ago';\n    }\n    else if (hour > 0) {\n      time += hour + ' hour';\n      if (hour > 1)\n        time += 's';\n      time += ' ago';\n    }\n    else if (minute > 0) {\n      time += minute + ' minute';\n      if (minute > 1)\n        time += 's';\n      time += ' ago';\n    }\n    else if (seconds > 0) {\n      time += seconds + ' seconds';\n      if (seconds > 1)\n        time += 's';\n      time += ' ago';\n    }\n    return time;\n  }\n  postMessage = (postDate) => {\n    let d = new Date();\n    let n = d.getMilliseconds();\n\n    let postAgeInMilSec = postDate - n;\n    let postAage = this.convertMS(postAgeInMilSec);\n    return postAage;\n\n  }\n  getText = (text, searchText) => {\n    return searchText ? this.getTextWithHighlights(text, searchText) : text;\n  }\n  getTextWithHighlights = (text, searchText) => {\n    searchText = searchText.split(\" \");\n    searchText.forEach(eachQuery => {\n      const regex = new RegExp(eachQuery, 'gi');\n      text = text.replaceAll(regex, `<mark class=\"highlight\">$&</mark>`);\n\n    });\n    return <span dangerouslySetInnerHTML={{ __html: text }} />;\n  }\n\n  render() {\n    let searchResults = [];\n    let result = _.cloneDeep(this.state.result);\n    let thisPar = this;\n    var t;\n    if (result.length > 0) {\n\n      result.forEach(function (item, index) {\n        searchResults.push(\n          <div key={index} className=\"padding\">\n\n            {item.url || item.title ?\n              <div className=\"subList\">\n\n                <span className=\"spanWithBlack\" id={\"spanDemo\"} key={index} >{item.title ?\n                  thisPar.getText(item.title, thisPar.state.query) : null} </span>\n                <span className=\"storyUrl\">{item.url ? '(' : null} {item.url ?\n                  thisPar.getText(item.url, thisPar.state.query) : null} {item.url ? ')' : null} </span>\n\n              </div>\n              :\n              null\n            }\n            {item.author || item.num_comments ?\n              <div className=\"subList\">\n                {item.author ?\n                  <span>\n                    Author: {thisPar.getText(item.author, thisPar.state.query)}\n                  </span>\n                  :\n                  null}\n                {item.num_comments ?\n                  <span>\n                    {item.author ? <React.Fragment> | </React.Fragment> : null}\n                    comments: {item.num_comments}\n                  </span>\n                  :\n                  null}\n                {item.created_at_i ?\n                  <span>\n                    {item.author || item.num_comments ? <React.Fragment> | </React.Fragment> : null}\n                    {thisPar.postMessage(item.created_at_i)}\n                  </span>\n                  :\n                  null}\n\n              </div>\n              : null}\n            {item.story_text ? <div className=\"subList spanWithBlack\">\n              {thisPar.getText(item.story_text, thisPar.state.query)}\n            </div> : null}\n\n            <hr className=\"horizontalLine\" />\n          </div>\n        )\n      })\n    }\n\n    return (\n      <div className=\"maindiv\">\n        <h2>\n          Search Hacker News\n        </h2>\n        <div className=\"dropDown\">\n          <div className={cx(\"\")} >\n            <img src={searchIcon} alt=\"searchIcon\" className=\"searchIcon\" />\n            <input className=\"searchBox\"\n              id=\"mySearchInput\"\n              placeholder=\"Type here to start searching\"\n              onKeyUp={(event) => this.handleOnInputChange(event)}\n              autoComplete=\"off\"\n            />\n\n            {this.props.getDataState === \"LOADING\" ? <div className=\"loader\"></div> :\n              _.isEmpty(this.state.query) || result.length > 0\n                ? <div className=\"itemResults\">\n                  {searchResults}\n                </div>\n                : <div className=\"itemResults\"> \"NO DATA FOUND WITH THE SEARCH\" </div>}\n          </div>\n\n\n\n\n\n        </div>\n\n\n      </div>\n    );\n  }\n\n}\nconst mapStateToProps = state => {\n  return {\n    data: state.data,\n    lastPage: state.lastPage,\n    getDataState: state.getDataState,\n    hitsPerQuery: state.hitsPerQuery,\n    hitsPerPage: state.hitsPerPage,\n    queryHitted: state.queryHitted\n  };\n};\n\n\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    getData: (query, page) => dispatch(actions.getData(query, page)),\n  };\n};\n\nexport default (connect(mapStateToProps, mapDispatchToProps)(HomePage));\n\n"]},"metadata":{},"sourceType":"module"}