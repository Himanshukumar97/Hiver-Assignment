{"ast":null,"code":"var _jsxFileName = \"/Users/himanshukumar/Documents/hiver-assignment/src/pages/Home/index.js\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport searchIcon from './search.png';\nimport './index.css';\nimport * as actions from './Store/action';\nimport cx from 'classnames';\nimport { NavLink } from \"react-router-dom\";\nimport _ from 'lodash';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass HomePage extends Component {\n  constructor(props) {\n    super(props);\n\n    this.intersectFunc = (a, b) => {\n      console.log(\"a \", a);\n      console.log(\"b\", b);\n      var t; // if (b.length > a.length) {\n      //   t = b;\n      //   b = a;\n      //   a = t; // indexOf to loop over shorter\n      // }\n\n      return b.filter(function (e) {\n        if (a.includes(e)) return true;\n      }).filter(function (e, i, c) {\n        // extra step to remove duplicates\n        return c.indexOf(e) === i;\n      });\n    };\n\n    this.searchFilter = query => {\n      let searchArray = [];\n      if (_.isEmpty(query)) query = this.state.query;\n      let thisPar = this;\n\n      let resultArray = _.cloneDeep(this.props.data);\n\n      if (_.isEmpty(query)) {\n        searchArray = [];\n      } else {\n        searchArray = resultArray.filter(function (obj) {\n          let keys = ['title', 'url', 'author', 'story_text', 'comment_text'];\n          var intersectfunc = thisPar.intersectFunc;\n          query = query.toLowerCase();\n          let queryArray = query.split(\" \"); // console.log(\"obj title \",obj.title)\n          // console.log(\"obj  url\",obj.url)\n          // console.log(\"obj  author\",obj.author)\n\n          console.log(\"obj story_text\", obj.story_text);\n\n          for (var objkey in obj) {\n            if (obj.hasOwnProperty(objkey) && _.includes(keys, objkey) && !_.isEmpty(obj[objkey])) {\n              console.log(\"KEY \", objkey, obj[objkey]);\n              let intersectedArray = intersectfunc(obj[objkey].toLowerCase(), queryArray);\n              console.log(\"intersectedArray \", intersectedArray);\n\n              if (intersectedArray.length == queryArray.length) {\n                return true;\n              }\n            }\n          }\n        });\n      }\n\n      if (searchArray.length > 10) searchArray = searchArray.slice(0, 10);\n      this.setState({\n        result: searchArray\n      });\n      return searchArray;\n    };\n\n    this.debounceFunction = (query, page, fn, td) => {\n      let thisPar = this;\n      return function () {\n        const context = this;\n        clearTimeout(thisPar.debounceTimer);\n        thisPar.debounceTimer = setTimeout(() => fn.call(context, query, page), td);\n      };\n    };\n\n    this.handleOnInputChange = event => {\n      const query = event.target.value;\n      let page = 1;\n      let searchArray = this.searchFilter(query);\n      console.log(\"searchArray \", searchArray.length);\n\n      if (searchArray.length < 10) {\n        const debouncer = this.debounceFunction(query, page, this.props.getData, 2000);\n        debouncer();\n      }\n\n      this.setState({\n        query\n      });\n    };\n\n    this.state = {\n      query: '',\n      result: [],\n      threshold: 3,\n      focusedItem: -1\n    };\n    this.debounceTimer = null;\n  }\n\n  componentDidMount() {}\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevProps.data !== this.props.data) {\n      this.searchFilter();\n    }\n  }\n\n  render() {\n    let searchResults = [];\n\n    let result = _.cloneDeep(this.state.result);\n\n    if (result.length > 0) {\n      result.forEach(function (item, index) {\n        searchResults.push( /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"padding\",\n          children: [item.url || item.title ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"subList\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"spanWithBlack\",\n              id: \"span\" + index,\n              children: item.title ? item.title : \"\"\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 138,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"storyUrl\",\n              children: item.url ? '(' + item.url + ')' : \"\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 139,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 15\n          }, this) : null, item.author || item.num_comments ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"subList\",\n            children: [item.author ? /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"Author: \", item.author]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 148,\n              columnNumber: 19\n            }, this) : null, item.num_comments ? /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [item.author ? /*#__PURE__*/_jsxDEV(React.Fragment, {\n                children: \" | \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 155,\n                columnNumber: 36\n              }, this) : null, \"comments: \", item.num_comments]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 154,\n              columnNumber: 19\n            }, this) : null, item.relevancy_score ? /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [item.author ? /*#__PURE__*/_jsxDEV(React.Fragment, {\n                children: \" | \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 162,\n                columnNumber: 36\n              }, this) : null, \"relevancy_score: \", item.relevancy_score]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 161,\n              columnNumber: 19\n            }, this) : null]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 15\n          }, this) : null, item.story_text ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"subList spanWithBlack\",\n            children: item.story_text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 32\n          }, this) : null, /*#__PURE__*/_jsxDEV(\"hr\", {\n            className: \"horizontalLine\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 174,\n            columnNumber: 13\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 11\n        }, this));\n      });\n    }\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"maindiv\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Search Hacker News\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"dropDown\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: cx(\"\"),\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: searchIcon,\n            alt: \"searchIcon\",\n            className: \"searchIcon\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            className: \"searchBox\",\n            id: \"mySearchInput\",\n            placeholder: \"Type here to start searching\",\n            onKeyUp: event => this.handleOnInputChange(event),\n            autoComplete: \"off\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 11\n        }, this), this.props.getDataState === \"LOADING\" ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"loader\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 52\n        }, this) : this.state.result ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"itemResults\",\n          children: searchResults\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 17\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"itemResults\",\n          children: \" \\\"NO DATA FOUND\\\" \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    data: state.data,\n    getDataState: state.getDataState,\n    lastNullQuery: state.lastNullQuery\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    getData: (query, page) => dispatch(actions.getData(query, page))\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(HomePage);","map":{"version":3,"sources":["/Users/himanshukumar/Documents/hiver-assignment/src/pages/Home/index.js"],"names":["React","Component","connect","searchIcon","actions","cx","NavLink","_","HomePage","constructor","props","intersectFunc","a","b","console","log","t","filter","e","includes","i","c","indexOf","searchFilter","query","searchArray","isEmpty","state","thisPar","resultArray","cloneDeep","data","obj","keys","intersectfunc","toLowerCase","queryArray","split","story_text","objkey","hasOwnProperty","intersectedArray","length","slice","setState","result","debounceFunction","page","fn","td","context","clearTimeout","debounceTimer","setTimeout","call","handleOnInputChange","event","target","value","debouncer","getData","threshold","focusedItem","componentDidMount","componentDidUpdate","prevProps","prevState","render","searchResults","forEach","item","index","push","url","title","author","num_comments","relevancy_score","getDataState","mapStateToProps","lastNullQuery","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport searchIcon from './search.png';\nimport './index.css';\nimport * as actions from './Store/action';\nimport cx from 'classnames';\nimport { NavLink } from \"react-router-dom\";\nimport _ from 'lodash';\nclass HomePage extends Component {\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      query: '',\n      result: [],\n      threshold: 3,\n      focusedItem: -1,\n    }\n    this.debounceTimer = null;\n  }\n\n  componentDidMount() {\n  }\n  componentDidUpdate(prevProps, prevState) {\n    if (prevProps.data !== this.props.data) {\n      this.searchFilter();\n    }\n  }\n\n  intersectFunc = (a, b) => {\n    console.log(\"a \",a);\n    console.log(\"b\",b);\n    \n    \n    var t;\n    // if (b.length > a.length) {\n    //   t = b;\n    //   b = a;\n    //   a = t; // indexOf to loop over shorter\n    // }\n    return b.filter(function (e) {\n      if(a.includes(e))\n        return true;\n    }).filter(function (e, i, c) { // extra step to remove duplicates\n      return c.indexOf(e) === i;\n    });\n\n  }\n  searchFilter = (query) => {\n    let searchArray = [];\n    if(_.isEmpty(query))\n      query = this.state.query;\n    let thisPar = this;\n    let resultArray = _.cloneDeep(this.props.data);\n    if (_.isEmpty(query)) {\n      searchArray = [];\n    }\n    else {\n      searchArray = resultArray.filter(function (obj) {\n\n        let keys = ['title', 'url', 'author', 'story_text','comment_text']\n        var intersectfunc = thisPar.intersectFunc;\n        \n        query = query.toLowerCase();\n        let queryArray = query.split(\" \");\n        // console.log(\"obj title \",obj.title)\n        // console.log(\"obj  url\",obj.url)\n        // console.log(\"obj  author\",obj.author)\n        console.log(\"obj story_text\",obj.story_text);\n        \n        for (var objkey in obj) {\n          if (obj.hasOwnProperty(objkey) && _.includes(keys, objkey) && !_.isEmpty(obj[objkey])) {\n            console.log(\"KEY \",objkey , obj[objkey]);\n            \n            let intersectedArray = intersectfunc(obj[objkey].toLowerCase(), queryArray) ;\n            console.log(\"intersectedArray \",intersectedArray);\n            \n            if(intersectedArray.length == queryArray.length )\n            {\n              return true; \n            }\n            \n          }\n        }\n        \n      });\n\n    }\n\n    if (searchArray.length > 10)\n      searchArray = searchArray.slice(0, 10);\n    this.setState({ result: searchArray });\n\n    return searchArray;\n\n  }\n\n  debounceFunction = (query, page, fn, td) => {\n\n    let thisPar = this;\n    return function () {\n      const context = this;\n      clearTimeout(thisPar.debounceTimer)\n      thisPar.debounceTimer = setTimeout(() => fn.call(context, query, page), td);\n    }\n\n  }\n\n\n  handleOnInputChange = (event) => {\n\n    const query = event.target.value;\n    let page = 1;\n    let searchArray = this.searchFilter(query)\n    console.log(\"searchArray \",searchArray.length);\n    \n    if (searchArray.length < 10) {\n      const debouncer = this.debounceFunction(query, page, this.props.getData, 2000);\n      debouncer();\n    }\n\n    this.setState({ query });\n\n\n  }\n\n  render() {\n    let searchResults = [];\n    let result = _.cloneDeep(this.state.result);\n    if (result.length > 0) {\n\n      result.forEach(function (item, index) {\n        searchResults.push(\n          <div key={index} className=\"padding\">\n\n            {item.url || item.title ?\n              <div className=\"subList\">\n                <span className=\"spanWithBlack\" id={\"span\" + index} key={index} >{item.title ? item.title : \"\"}</span>\n                <span className=\"storyUrl\">{item.url ? '(' + item.url + ')' : \"\"}</span>\n\n              </div>\n              :\n              null\n            }\n            {item.author || item.num_comments ?\n              <div className=\"subList\">\n                {item.author ?\n                  <span>\n                    Author: {item.author}\n                  </span>\n                  :\n                  null}\n                {item.num_comments ?\n                  <span>\n                    {item.author ? <React.Fragment> | </React.Fragment> : null}\n                    comments: {item.num_comments}\n                  </span>\n                  :\n                  null}\n                {item.relevancy_score ?\n                  <span>\n                    {item.author ? <React.Fragment> | </React.Fragment> : null}\n                    relevancy_score: {item.relevancy_score}\n                  </span>\n                  :\n                  null}\n\n              </div>\n              : null}\n            {item.story_text ? <div className=\"subList spanWithBlack\">\n              {item.story_text}\n            </div> : null}\n\n            <hr className=\"horizontalLine\" />\n          </div>\n        )\n      })\n    }\n\n    return (\n      <div className=\"maindiv\">\n        <h2>\n          Search Hacker News\n        </h2>\n        <div className=\"dropDown\">\n          <div className={cx(\"\")} >\n            <img src={searchIcon} alt=\"searchIcon\" className=\"searchIcon\" />\n            <input className=\"searchBox\"\n              id=\"mySearchInput\"\n              placeholder=\"Type here to start searching\"\n              onKeyUp={(event) => this.handleOnInputChange(event)}\n              autoComplete=\"off\"\n            />\n          </div>\n\n          {this.props.getDataState === \"LOADING\" ? <div className=\"loader\"></div> :\n            this.state.result\n              ? <div className=\"itemResults\">\n                {searchResults}\n              </div>\n              : <div className=\"itemResults\"> \"NO DATA FOUND\" </div>}\n\n\n\n        </div>\n\n\n      </div>\n    );\n  }\n\n}\nconst mapStateToProps = state => {\n  return {\n    data: state.data,\n    getDataState: state.getDataState,\n    lastNullQuery: state.lastNullQuery\n  };\n};\n\n\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    getData: (query, page) => dispatch(actions.getData(query, page)),\n  };\n};\n\nexport default (connect(mapStateToProps, mapDispatchToProps)(HomePage));\n\n"]},"metadata":{},"sourceType":"module"}