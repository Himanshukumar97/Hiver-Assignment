{"ast":null,"code":"import _classCallCheck from\"/Users/himanshukumar/Documents/hiver-assignment/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/himanshukumar/Documents/hiver-assignment/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/himanshukumar/Documents/hiver-assignment/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/himanshukumar/Documents/hiver-assignment/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/himanshukumar/Documents/hiver-assignment/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{connect}from'react-redux';import searchIcon from'./search.png';import'./index.css';import*as actions from'./Store/action';import cx from'classnames';import _ from'lodash';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var HomePage=/*#__PURE__*/function(_Component){_inherits(HomePage,_Component);var _super=_createSuper(HomePage);function HomePage(props){var _this;_classCallCheck(this,HomePage);_this=_super.call(this,props);_this.intersectFunc=function(a,b){return b.filter(function(e){if(a.includes(e))return true;}).filter(function(e,i,c){// extra step to remove duplicates\nreturn c.indexOf(e)===i;});};_this.searchFilter=function(query){var searchArray=[];if(_.isEmpty(query))query=_this.state.query;console.log(\"query search filter\",query);var thisPar=_assertThisInitialized(_this);var resultArray=_.cloneDeep(_this.props.data);if(_.isEmpty(query)){searchArray=[];}else{searchArray=resultArray.filter(function(obj){var keys=['title','url','author','story_text','story_title'];var intersectfunc=thisPar.intersectFunc;query=query.toLowerCase();var queryArray=query.split(\" \");for(var objkey in obj){if(obj.hasOwnProperty(objkey)&&_.includes(keys,objkey)&&!_.isEmpty(obj[objkey])){var intersectedArray=intersectfunc(obj[objkey].toLowerCase(),queryArray);if(intersectedArray.length===queryArray.length){return true;}}}});}if(searchArray.length>10)searchArray=searchArray.slice(0,10);_this.setState({result:searchArray});return searchArray;};_this.callAPI=function(query,page,changePage){if(changePage===true)_this.setState({page:page});_this.props.getData(query,page);};_this.debounceFunction=function(query,page,fn,td,changePage){var thisPar=_assertThisInitialized(_this);return function(){var context=this;clearTimeout(thisPar.debounceTimer);thisPar.debounceTimer=setTimeout(function(){return fn.call(context,query,page,changePage);},td);};};_this.handleOnInputChange=function(event){var query=event.target.value;var page=_this.state.page;var searchArray=_this.searchFilter(query);if(searchArray.length<10){var debouncer=_this.debounceFunction(query,page,_this.callAPI,1000);debouncer();}console.log(\"query input change\",query);_this.setState({query:query,page:1});};_this.convertMS=function(milliseconds){var day,hour,minute,seconds,week,month,year,time=\"\";seconds=Math.floor(milliseconds/1000);minute=Math.floor(seconds/60);seconds=seconds%60;hour=Math.floor(minute/60);minute=minute%60;day=Math.floor(hour/24);week=Math.floor(day/7);hour=hour%24;day=day%7;month=Math.floor(day/30);year=Math.floor(day/365);if(year>0){time+=year+' year';if(year>1)time+='s';time+=' ago';}else if(month>0){time+=month+' month';if(month>1)time+='s';time+=' ago';}else if(week>0){time+=week+' week';if(week>1)time+='s';time+=' ago';}else if(day>0){time+=day+' day';if(day>1)time+='s';time+=' ago';}else if(hour>0){time+=hour+' hour';if(hour>1)time+='s';time+=' ago';}else if(minute>0){time+=minute+' minute';if(minute>1)time+='s';time+=' ago';}else if(seconds>0){time+=seconds+' seconds';if(seconds>1)time+='s';time+=' ago';}return time;};_this.postMessage=function(postDate){var d=new Date();var n=d.getMilliseconds();var postAgeInMilSec=postDate-n;var postAage=_this.convertMS(postAgeInMilSec);return postAage;};_this.getText=function(text,searchText){return searchText?_this.getTextWithHighlights(text,searchText):text;};_this.getTextWithHighlights=function(text,searchText){searchText=searchText.split(\" \");searchText.forEach(function(eachQuery){var regex=new RegExp(eachQuery,'gi');text=text.replaceAll(regex,\"<mark class=\\\"highlight\\\">$&</mark>\");});return/*#__PURE__*/_jsx(\"span\",{dangerouslySetInnerHTML:{__html:text}});};_this.state={query:'',result:[],page:1};_this.debounceTimer=null;return _this;}_createClass(HomePage,[{key:\"componentDidMount\",value:function componentDidMount(){}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState){if(prevProps.data!==this.props.data&&(this.props.hitsPerQuery===this.props.hitsPerPage||this.props.lastPage===true)){this.searchFilter();}else if(!_.isEmpty(this.state.query)&&!_.isEmpty(this.props.queryHitted)&&this.props.queryHitted===this.state.query){if(this.props.data.length>0&&this.props.hitsPerQuery===this.props.hitsPerPage&&this.props.hitsPerPage>0&&this.state.result.length<10&&this.props.lastPage===false){console.log(\"prevState.query \",prevState.query,this.state.query);console.log(\"true \",this.state.page,this.props.hitsPerQuery,this.state.result.length);var page=this.state.page+1;var debouncer=this.debounceFunction(this.state.query,page,this.callAPI,1000,true);debouncer();}}}},{key:\"render\",value:function render(){var _this2=this;var searchResults=[];var result=_.cloneDeep(this.state.result);var thisPar=this;var t;if(result.length>0){result.forEach(function(item,index){searchResults.push(/*#__PURE__*/_jsxs(\"div\",{className:\"padding\",children:[item.url||item.title?/*#__PURE__*/_jsxs(\"div\",{className:\"subList\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"spanWithBlack\",id:\"spanDemo\",children:[item.title?thisPar.getText(item.title,thisPar.state.query):null,\" \"]},index),/*#__PURE__*/_jsxs(\"span\",{className:\"storyUrl\",children:[item.url?'(':null,\" \",item.url?thisPar.getText(item.url,thisPar.state.query):null,\" \",item.url?')':null,\" \"]})]}):null,item.author||item.num_comments?/*#__PURE__*/_jsxs(\"div\",{className:\"subList\",children:[item.author?/*#__PURE__*/_jsxs(\"span\",{children:[\"Author: \",thisPar.getText(item.author,thisPar.state.query)]}):null,item.num_comments?/*#__PURE__*/_jsxs(\"span\",{children:[item.author?/*#__PURE__*/_jsx(React.Fragment,{children:\" | \"}):null,\"comments: \",item.num_comments]}):null,item.created_at_i?/*#__PURE__*/_jsxs(\"span\",{children:[item.author||item.num_comments?/*#__PURE__*/_jsx(React.Fragment,{children:\" | \"}):null,thisPar.postMessage(item.created_at_i)]}):null]}):null,item.story_text?/*#__PURE__*/_jsx(\"div\",{className:\"subList spanWithBlack\",children:thisPar.getText(item.story_text,thisPar.state.query)}):null,/*#__PURE__*/_jsx(\"hr\",{className:\"horizontalLine\"})]},index));});}return/*#__PURE__*/_jsxs(\"div\",{className:\"maindiv\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Search Hacker News\"}),/*#__PURE__*/_jsx(\"div\",{className:\"dropDown\",children:/*#__PURE__*/_jsxs(\"div\",{className:cx(\"\"),children:[/*#__PURE__*/_jsx(\"img\",{src:searchIcon,alt:\"searchIcon\",className:\"searchIcon\"}),/*#__PURE__*/_jsx(\"input\",{className:\"searchBox\",id:\"mySearchInput\",placeholder:\"Type here to start searching\",onKeyUp:function onKeyUp(event){return _this2.handleOnInputChange(event);},autoComplete:\"off\"}),this.props.getDataState===\"LOADING\"?/*#__PURE__*/_jsx(\"div\",{className:\"loader\"}):_.isEmpty(this.state.query)||result.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"itemResults\",children:searchResults}):/*#__PURE__*/_jsx(\"div\",{className:\"itemResults\",children:\" \\\"NO DATA FOUND WITH THE SEARCH\\\" \"})]})})]});}}]);return HomePage;}(Component);var mapStateToProps=function mapStateToProps(state){return{data:state.data,lastPage:state.lastPage,getDataState:state.getDataState,hitsPerQuery:state.hitsPerQuery,hitsPerPage:state.hitsPerPage,queryHitted:state.queryHitted};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{getData:function getData(query,page){return dispatch(actions.getData(query,page));}};};export default connect(mapStateToProps,mapDispatchToProps)(HomePage);","map":{"version":3,"sources":["/Users/himanshukumar/Documents/hiver-assignment/src/pages/Home/index.js"],"names":["React","Component","connect","searchIcon","actions","cx","_","HomePage","props","intersectFunc","a","b","filter","e","includes","i","c","indexOf","searchFilter","query","searchArray","isEmpty","state","console","log","thisPar","resultArray","cloneDeep","data","obj","keys","intersectfunc","toLowerCase","queryArray","split","objkey","hasOwnProperty","intersectedArray","length","slice","setState","result","callAPI","page","changePage","getData","debounceFunction","fn","td","context","clearTimeout","debounceTimer","setTimeout","call","handleOnInputChange","event","target","value","debouncer","convertMS","milliseconds","day","hour","minute","seconds","week","month","year","time","Math","floor","postMessage","postDate","d","Date","n","getMilliseconds","postAgeInMilSec","postAage","getText","text","searchText","getTextWithHighlights","forEach","eachQuery","regex","RegExp","replaceAll","__html","prevProps","prevState","hitsPerQuery","hitsPerPage","lastPage","queryHitted","searchResults","t","item","index","push","url","title","author","num_comments","created_at_i","story_text","getDataState","mapStateToProps","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport searchIcon from './search.png';\nimport './index.css';\nimport * as actions from './Store/action';\nimport cx from 'classnames';\nimport _ from 'lodash';\nclass HomePage extends Component {\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      query: '',\n      result: [],\n      page: 1\n    }\n    this.debounceTimer = null;\n  }\n\n  componentDidMount() {\n  }\n  componentDidUpdate(prevProps, prevState) {\n    if (prevProps.data !== this.props.data && (this.props.hitsPerQuery === this.props.hitsPerPage || this.props.lastPage === true)) {\n      this.searchFilter();\n    }\n    else if (!_.isEmpty(this.state.query) && !_.isEmpty(this.props.queryHitted) &&\n      this.props.queryHitted === this.state.query) {\n      if (this.props.data.length > 0 && this.props.hitsPerQuery === this.props.hitsPerPage && this.props.hitsPerPage > 0 && this.state.result.length < 10 && this.props.lastPage === false) {\n        console.log(\"prevState.query \", prevState.query, this.state.query);\n\n        console.log(\"true \", this.state.page, this.props.hitsPerQuery, this.state.result.length);\n        let page = (this.state.page) + 1;\n        const debouncer = this.debounceFunction(this.state.query, page, this.callAPI, 1000, true);\n        debouncer();\n      }\n    }\n  }\n\n  intersectFunc = (a, b) => {\n    return b.filter(function (e) {\n      if (a.includes(e))\n        return true;\n    }).filter(function (e, i, c) { // extra step to remove duplicates\n      return c.indexOf(e) === i;\n    });\n\n  }\n  searchFilter = (query) => {\n\n\n    let searchArray = [];\n    if (_.isEmpty(query))\n      query = this.state.query;\n    console.log(\"query search filter\", query);\n\n    let thisPar = this;\n    let resultArray = _.cloneDeep(this.props.data);\n    if (_.isEmpty(query)) {\n      searchArray = [];\n    }\n    else {\n      searchArray = resultArray.filter(function (obj) {\n\n        let keys = ['title', 'url', 'author', 'story_text', 'story_title']\n        var intersectfunc = thisPar.intersectFunc;\n\n        query = query.toLowerCase();\n        let queryArray = query.split(\" \");\n        for (var objkey in obj) {\n          if (obj.hasOwnProperty(objkey) && _.includes(keys, objkey) && !_.isEmpty(obj[objkey])) {\n            let intersectedArray = intersectfunc(obj[objkey].toLowerCase(), queryArray);\n            if (intersectedArray.length === queryArray.length) {\n              return true;\n            }\n\n          }\n        }\n\n      });\n\n    }\n\n    if (searchArray.length > 10)\n      searchArray = searchArray.slice(0, 10);\n\n    this.setState({ result: searchArray });\n    return searchArray;\n\n  }\n\n  callAPI = (query, page,changePage) =>{\n    if (changePage === true)\n      this.setState({ page });\n\n      this.props.getData(query,page);\n    \n  }\n  debounceFunction = (query, page, fn, td, changePage) => {\n\n    let thisPar = this;\n    return function () {\n      const context = this;\n      clearTimeout(thisPar.debounceTimer)\n      thisPar.debounceTimer = setTimeout(() => fn.call(context, query, page,changePage), td);\n    }\n\n  }\n\n\n  handleOnInputChange = (event) => {\n\n    const query = event.target.value;\n    let page = this.state.page;\n    let searchArray = this.searchFilter(query)\n    if (searchArray.length < 10) {\n      const debouncer = this.debounceFunction(query, page, this.callAPI, 1000);\n      debouncer();\n    }\n\n    console.log(\"query input change\", query);\n\n    this.setState({ query, page: 1 });\n\n\n  }\n  convertMS = (milliseconds) => {\n    let day, hour, minute, seconds, week, month, year, time = \"\";\n    seconds = Math.floor(milliseconds / 1000);\n    minute = Math.floor(seconds / 60);\n    seconds = seconds % 60;\n    hour = Math.floor(minute / 60);\n    minute = minute % 60;\n    day = Math.floor(hour / 24);\n    week = Math.floor(day / 7);\n    hour = hour % 24;\n    day = day % 7;\n    month = Math.floor(day / 30);\n    year = Math.floor(day / 365);\n\n    if (year > 0) {\n      time += year + ' year';\n      if (year > 1)\n        time += 's';\n      time += ' ago';\n    }\n\n    else if (month > 0) {\n      time += month + ' month';\n      if (month > 1)\n        time += 's';\n      time += ' ago';\n    }\n    else if (week > 0) {\n      time += week + ' week';\n      if (week > 1)\n        time += 's';\n      time += ' ago';\n    }\n    else if (day > 0) {\n      time += day + ' day';\n      if (day > 1)\n        time += 's';\n      time += ' ago';\n    }\n    else if (hour > 0) {\n      time += hour + ' hour';\n      if (hour > 1)\n        time += 's';\n      time += ' ago';\n    }\n    else if (minute > 0) {\n      time += minute + ' minute';\n      if (minute > 1)\n        time += 's';\n      time += ' ago';\n    }\n    else if (seconds > 0) {\n      time += seconds + ' seconds';\n      if (seconds > 1)\n        time += 's';\n      time += ' ago';\n    }\n    return time;\n  }\n  postMessage = (postDate) => {\n    let d = new Date();\n    let n = d.getMilliseconds();\n\n    let postAgeInMilSec = postDate - n;\n    let postAage = this.convertMS(postAgeInMilSec);\n    return postAage;\n\n  }\n  getText = (text, searchText) => {\n    return searchText ? this.getTextWithHighlights(text, searchText) : text;\n  }\n  getTextWithHighlights = (text, searchText) => {\n    searchText = searchText.split(\" \");\n    searchText.forEach(eachQuery => {\n      const regex = new RegExp(eachQuery, 'gi');\n      text = text.replaceAll(regex, `<mark class=\"highlight\">$&</mark>`);\n\n    });\n    return <span dangerouslySetInnerHTML={{ __html: text }} />;\n  }\n\n  render() {\n    let searchResults = [];\n    let result = _.cloneDeep(this.state.result);\n    let thisPar = this;\n    var t;\n    if (result.length > 0) {\n\n      result.forEach(function (item, index) {\n        searchResults.push(\n          <div key={index} className=\"padding\">\n\n            {item.url || item.title ?\n              <div className=\"subList\">\n\n                <span className=\"spanWithBlack\" id={\"spanDemo\"} key={index} >{item.title ?\n                  thisPar.getText(item.title, thisPar.state.query) : null} </span>\n                <span className=\"storyUrl\">{item.url ? '(' : null} {item.url ?\n                  thisPar.getText(item.url, thisPar.state.query) : null} {item.url ? ')' : null} </span>\n\n              </div>\n              :\n              null\n            }\n            {item.author || item.num_comments ?\n              <div className=\"subList\">\n                {item.author ?\n                  <span>\n                    Author: {thisPar.getText(item.author, thisPar.state.query)}\n                  </span>\n                  :\n                  null}\n                {item.num_comments ?\n                  <span>\n                    {item.author ? <React.Fragment> | </React.Fragment> : null}\n                    comments: {item.num_comments}\n                  </span>\n                  :\n                  null}\n                {item.created_at_i ?\n                  <span>\n                    {item.author || item.num_comments ? <React.Fragment> | </React.Fragment> : null}\n                    {thisPar.postMessage(item.created_at_i)}\n                  </span>\n                  :\n                  null}\n\n              </div>\n              : null}\n            {item.story_text ? <div className=\"subList spanWithBlack\">\n              {thisPar.getText(item.story_text, thisPar.state.query)}\n            </div> : null}\n\n            <hr className=\"horizontalLine\" />\n          </div>\n        )\n      })\n    }\n\n    return (\n      <div className=\"maindiv\">\n        <h2>\n          Search Hacker News\n        </h2>\n        <div className=\"dropDown\">\n          <div className={cx(\"\")} >\n            <img src={searchIcon} alt=\"searchIcon\" className=\"searchIcon\" />\n            <input className=\"searchBox\"\n              id=\"mySearchInput\"\n              placeholder=\"Type here to start searching\"\n              onKeyUp={(event) => this.handleOnInputChange(event)}\n              autoComplete=\"off\"\n            />\n\n            {this.props.getDataState === \"LOADING\" ? <div className=\"loader\"></div> :\n              _.isEmpty(this.state.query) || result.length > 0\n                ? <div className=\"itemResults\">\n                  {searchResults}\n                </div>\n                : <div className=\"itemResults\"> \"NO DATA FOUND WITH THE SEARCH\" </div>}\n          </div>\n\n\n\n\n\n        </div>\n\n\n      </div>\n    );\n  }\n\n}\nconst mapStateToProps = state => {\n  return {\n    data: state.data,\n    lastPage: state.lastPage,\n    getDataState: state.getDataState,\n    hitsPerQuery: state.hitsPerQuery,\n    hitsPerPage: state.hitsPerPage,\n    queryHitted: state.queryHitted\n  };\n};\n\n\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    getData: (query, page) => dispatch(actions.getData(query, page)),\n  };\n};\n\nexport default (connect(mapStateToProps, mapDispatchToProps)(HomePage));\n\n"]},"metadata":{},"sourceType":"module"}